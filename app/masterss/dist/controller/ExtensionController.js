sap.ui.define(["sap/m/MessageBox","sap/m/MessageToast","sap/ui/core/UIComponent"],function(e,t,n){"use strict";function o(n,o){var a;function r(e){a&&a.getBeginButton().setEnabled(e)}function l(e){a.setBusy(e)}function i(){a&&a.close()}function s(t,n,o){e.error("Upload failed",{title:"Error"})}function c(e){return sap.ui.core.Fragment.byId("excelUploadDialog",e)}return{onBeforeOpen:function(e){a=e.getSource();n.addDependent(a)},onAfterClose:function(e){n.removeDependent(a);a.destroy();a=undefined},onOk:function(e){l(true);var t=c("uploader");var a=new sap.ui.unified.FileUploaderParameter;a.setName("slug");a.setValue(o);t.removeHeaderParameter("slug");t.addHeaderParameter(a);var r=n._controller.extensionAPI._controller._oAppComponent.getManifestObject().resolveUri("/odata/v4/application/UploadXl/excel");t.setUploadUrl(r);t.checkFileReadable().then(function(){t.upload()}).catch(function(e){s("The file cannot be read.");l(false)})},onCancel:function(e){i()},onTypeMismatch:function(e){var t=e.getSource().getFileType().map(function(e){return"*."+e}).join(", ");s("The file type *."+e.getParameter("fileType")+" is not supported. Choose one of the following types: "+t)},onFileAllowed:function(e){r(true)},onFileEmpty:function(e){r(false)},onUploadComplete:function(e){var o=e.getParameter("status");var a=e.getSource();a.clear();r(false);l(false);if(o>=400){var c;try{c=JSON.parse(e.getParameter("responseRaw"))}catch(t){c=e.getParameter("responseRaw")}if(c&&c.error&&c.error.message){s(c.error.code,c.error.target,c&&c.error&&c.error.message)}}else{t.show("File read successfully");n.refresh();i();var d=sap.ui.xmlfragment("masterss.fragments.warning",this);d.open();setTimeout(function(){d.close()},4e3);setTimeout(function(){location.reload()},5e3)}}}}return{Upload:function(e,t){debugger;this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Company_code")}).then(function(e){e.open()})},cost_Center:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Cost_center")}).then(function(e){e.open()})},currency:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Currency")}).then(function(e){e.open()})},default_Master:function(){debugger;this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Default_master")}).then(function(e){e.open()})},dept_Budget:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Dept_budget")}).then(function(e){e.open()})},department:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Department")}).then(function(e){e.open()})},gl_Account:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"G_L_Account")}).then(function(e){e.open()})},internal_Order:function(){this.loadFragment({id:"excelUploadDialog",name:"master.fragments.ExcelUploadDialog",controller:o(this,"Internal_order")}).then(function(e){e.open()})},item_Category:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Item_category")}).then(function(e){e.open()})},jurisdiction_Code:function(){this.loadFragment({id:"excelUploadDialog",name:"master.fragments.ExcelUploadDialog",controller:o(this,"Jurisdiction_code")}).then(function(e){e.open()})},material_Master:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Material_master")}).then(function(e){e.open()})},plant:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Plant")}).then(function(e){e.open()})},tax_Code:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Tax_code")}).then(function(e){e.open()})},unit_Measures:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Unit_Measures")}).then(function(e){e.open()})},vendor_Master:function(){this.loadFragment({id:"excelUploadDialog",name:"masterss.fragments.ExcelUploadDialog",controller:o(this,"Vendor_master")}).then(function(e){e.open()})}}});